{% extends "../partials/layout.njk" %}

{% set pageTitle = applicationName + " - Search" %}
{% from "moj/components/search/macro.njk" import mojSearch %}

{% block content %}
  <h1 class="govuk-heading-m">Search for a submitted form</h1>

  {{ mojSearch({
    action: '#',
    method: 'get',
    input: {
      id: 'search',
      name: 'searchTerm'
    },
    hint: {
      text: 'Enter the device wearer\'s full name. For example Bob Smith.'
    },
    button: {
      text: 'Search',
      classes: "govuk-button--secondary"
    }
  }) }}

  <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">

  <div id="ordersList">
    {% if emptySearch %}
	<h2 class="govuk-heading-m">You have not entered any search terms</h2>
	<p>Try searching using the device wearer's:</p>
	<ul class="govuk-list govuk-list--bullet">
	  <li>first name and surname</li>
	</ul>
    {% endif %}

    {% if noResults %}
	<h2 class="govuk-heading-m">No results found for '{{ searchTerm }}'</h2>

	<p>Check spelling is correct.</p>

	<p>Try searching using the device wearer's full name.</p>

	<div class="govuk-warning-text">
          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
          <strong class="govuk-warning-text__text">
            <span class="govuk-visually-hidden">Warning</span>
            <h2 class="govuk-heading-s">Can't find what you are looking for?</h2>
            If the form is not listed in the search results, it may be an emailed form so not available online.
            <br>
            
            <a href="new-form?section-1-complete=false&amp;section-2-complete=false&amp;section-3-complete=false&amp;section-4-complete=false&amp;section-5-complete=false&amp;section-6-complete=false&amp;view=none&amp;newform=false">Tell us about changes to a form sent by email</a>.
          </strong>
        </div>
    {% endif %}

    <ul class="govuk-task-list">
      {% for order in orders %}
        <li class="govuk-task-list__item govuk-task-list__item--with-link">
          <div class="govuk-task-list__name-and-hint">
            <a class="govuk-link govuk-task-list__link" href="{{ order.summaryUri }}" aria-describedby="company-details-1-status">
              {{ order.displayName }}
            </a>
          </div>
          <div class="govuk-task-list__status">
            {% if order.type == 'VARIATION' %}
              <strong class="govuk-tag govuk-tag--blue">
                Variation
              </strong>
            {% endif %}
            {% if order.status == 'SUBMITTED' %}
              <strong class="govuk-tag govuk-tag--green">
                Submitted
              </strong>
            {% elif order.status == 'ERROR' %}
              <strong class="govuk-tag govuk-tag--red">
                Failed to submit
              </strong>            
            {% else %}
              <strong class="govuk-tag govuk-tag--grey">
                Draft
              </strong>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
  </div>

{% endblock %}

