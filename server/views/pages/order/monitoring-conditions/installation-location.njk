{% extends "../../../partials/form-layout.njk" %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% set section = content.pages.installationLocation.section %}
{% set heading = content.pages.installationLocation.title %}
{% set legend = content.pages.installationLocation.legend %}
{% set helpText = content.pages.installationLocation.helpText %}
{% set questions = content.pages.installationLocation.questions %}
{% set questionName = "Installation Location"%}
{% block formInputs %}

  {% set detailsTextHtml %}
    <ul class="govuk-list govuk-list--bullet">
      <li>Under 18 years at the point of release.</li>
      <li>Any case which has an NSD agreed bespoke EM violation reporting protocol in place (i.e. Specials).</li>
      <li>Anyone who is NFA. However, please note the AML NFA cases can still be tagged at the probation office under the business-as-usual EM process.</li>
      <li>Non-curfew location monitoring e.g. (exclusion zone or trail monitoring) cases which have a licence condition that restricts the use and/or possession of a mobile phone.</li>
      <li>Non-curfew location monitoring e.g. (exclusion zone or trail monitoring) cases which also have an EM immigration bail order in place. </li>
    </ul>
  {% endset %}

  {% set hintHtml %}
    {% if pilotPrison %}
      {% if not fixedAddressExist %}
        If the device wearer has no fixed address then they are out of scope of the install at source pilot. The normal business process should be followed and installation of the tag should be at the probation office.
      {% endif %}
      {{ govukDetails({
        classes: "govuk-!-margin-top-5",
        summaryText: "Cases that are out of scope of the install at source pilot",
        html: detailsTextHtml
      }) }}
    {% endif %}
  {% endset %}

  {% set items =[
        {
          value: "PRIMARY",
          text: "Device wearer has no fixed address" if not primaryAddressView.value else primaryAddressView.value,
          disabled: not isOrderEditable or not primaryAddressView.value
        },
        {
          value: "PRISON",
          text: "At a prison",
          disabled: not isOrderEditable
        },
        {
          value: "PROBATION_OFFICE",
          text: "At a probation office",
          disabled: not isOrderEditable
        }
    ] %}
  {% if not fixedAddressExist %}
    {% set items = items.concat([{
      value: "ANOTHER_ADDRESS",
      text: "At another address",
      disabled: not isOrderEditable
    }]) %}
  {% endif %}

  {{ govukRadios({
    name: "location",
    fieldset: {
      legend: {
        text: questions.location.text,
        isPageHeading: true,
        classes: "govuk-fieldset__legend--l"
      }
    },
    hint: {
      html: hintHtml
    },
    items: items,
    value: location.value,
    errorMessage: location.error
  }) }}
{% endblock %}
